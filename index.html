
<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="utf-8" />
    <title>t2o0n321.blog</title>
    <meta name="author" content="t2o0n321" />
    <meta name="description" content="t2o0n321 的部落格，記錄生活點滴、學習筆記、程式開發等。" />
    <meta name="keywords" content="" />
    <meta
        name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"
    />
    <link rel="icon" href="/images/avatar.gif" />
    <link rel="preconnect" href="https://cdnjs.cloudflare.com" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/vue/3.5.13/vue.global.prod.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" />
<link rel="preconnect" href="https://fonts.googleapis.com" />
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
<link
    rel="stylesheet"
    href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;500;600;700&family=Lexend:wght@400;500;600;700;800;900&family=Noto+Sans+SC:wght@400;500;600;700;800;900&display=swap"
/>
<script> const mixins = {}; </script>

<script src="https://polyfill.alicdn.com/v3/polyfill.min.js?features=default"></script>


<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/highlight.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlightjs-line-numbers.js/2.6.0/highlightjs-line-numbers.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/default.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/languages/bash.min.js"></script>
<link
    rel="stylesheet"
    href="https://s4.zstatic.net/ajax/libs/highlight.js/11.9.0/styles/github.min.css"
/>
<script src="/js/lib/highlight.js"></script>


<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/contrib/auto-render.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css" />
<script src="/js/lib/math.js"></script>


<script src="/js/lib/preview.js"></script>





<script src="/js/lib/home.js"></script>

<link rel="stylesheet" href="/css/main.css" />

<meta name="generator" content="Hexo 7.3.0"></head>
<body>
    <div id="layout">
        <transition name="fade">
            <div id="loading" v-show="loading">
                <div id="loading-circle">
                    <h2>LOADING</h2>
                    <p>載入過慢請開啟暫存 瀏覽器默認開啟</p>
                    <img src="/images/loading.gif" />
                </div>
            </div>
        </transition>
        <div id="menu" :class="{ hidden: hiddenMenu, 'menu-color': menuColor}">
    <nav id="desktop-menu">
        <a class="title" href="/">
            <span>T2O0N321.BLOG</span>
        </a>
        
        <a href="/">
            <i class="fa-solid fa-house fa-fw"></i>
            <span>&ensp;Home</span>
        </a>
        
        <a href="/about">
            <i class="fa-solid fa-id-card fa-fw"></i>
            <span>&ensp;About</span>
        </a>
        
        <a href="/archives">
            <i class="fa-solid fa-box-archive fa-fw"></i>
            <span>&ensp;Archives</span>
        </a>
        
        <a href="/categories">
            <i class="fa-solid fa-bookmark fa-fw"></i>
            <span>&ensp;Categories</span>
        </a>
        
        <a href="/tags">
            <i class="fa-solid fa-tags fa-fw"></i>
            <span>&ensp;Tags</span>
        </a>
        
    </nav>
    <nav id="mobile-menu">
        <div class="title" @click="showMenuItems = !showMenuItems">
            <i class="fa-solid fa-bars fa-fw"></i>
            <span>&emsp;T2O0N321.BLOG</span>
        </div>
        <transition name="slide">
            <div class="items" v-show="showMenuItems">
                
                <a href="/">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-house fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">Home</div>
                    </div>
                </a>
                
                <a href="/about">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-id-card fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">About</div>
                    </div>
                </a>
                
                <a href="/archives">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-box-archive fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">Archives</div>
                    </div>
                </a>
                
                <a href="/categories">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-bookmark fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">Categories</div>
                    </div>
                </a>
                
                <a href="/tags">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-tags fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">Tags</div>
                    </div>
                </a>
                
            </div>
        </transition>
    </nav>
</div>
<transition name="fade">
    <div id="menu-curtain" @click="showMenuItems = !showMenuItems" v-show="showMenuItems"></div>
</transition>

        <div id="main" :class="loading ? 'into-enter-from': 'into-enter-active'">
            <div id="home-head">
    <div
        id="home-background"
        ref="homeBackground"
        data-images="/images/gura1.jpg"
    ></div>
    <div id="home-info" @click="homeClick">
        <span class="loop"></span>
        <span class="loop"></span>
        <span class="loop"></span>
        <span class="loop"></span>
        <span class="info">
            <div class="wrap">
                <h1>t2o0n321.blog</h1>
                <h3>t2o0n321 ㄟ 個人部落格</h3>
                <h5>t2o0n321 的部落格，記錄生活點滴、學習筆記、程式開發等。</h5>
            </div>
        </span>
    </div>
</div>
<div
    id="home-posts-wrap"
    ref="homePostsWrap"
    true
>
    <div id="home-posts">
        

<div class="post">
    <a href="/2025/08/04/Understanding-Signal-Protocol-X3DH-Protocol/">
        <h2 class="post-title">Understanding the Signal Protocol and X3DH Key Agreement</h2>
    </a>
    <div class="category-and-date">
        
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2025/8/4
        </span>
        
        
    </div>
    <div class="description">
        <div class="content" v-pre>
            
            <blockquote>
<p>本文參考並改進自 <a
target="_blank" rel="noopener" href="https://blog.yarsalabs.com/understanding-signal-protocol-for-end-to-end-encryption/">Yarsa
Labs 部落格文章</a> 及 <a
target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=1R8lruHAbvY">Monica 的 YouTube
影片</a>。</p>
</blockquote>
<h1 id="目錄">目錄</h1>
<ul>
<li><a href="#前言">前言</a></li>
<li><a href="#簡介">簡介</a></li>
<li><a href="#用戶註冊時的密鑰生成">用戶註冊時的密鑰生成</a>
<ul>
<li><a
href="#迪菲-赫爾曼密鑰交換算法diffie-hellman-key-exchange">迪菲-赫爾曼密鑰交換算法（Diffie-Hellman
Key Exchange）</a></li>
<li><a href="#x3dh-密鑰協議extended-triple-diffie-hellman">X3DH
密鑰協議（Extended Triple Diffie-Hellman）</a>
<ul>
<li><a href="#協議背景與非同步需求">協議背景與非同步需求</a></li>
<li><a href="#協議參與者與伺服器角色">協議參與者與伺服器角色</a></li>
<li><a href="#x3dh-三個主要步驟">X3DH 三個主要步驟</a></li>
<li><a href="#密鑰類型與用途">密鑰類型與用途</a></li>
<li><a href="#alice-的密鑰計算與初始訊息">Alice
的密鑰計算與初始訊息</a></li>
<li><a href="#bob-的訊息處理與驗證">Bob 的訊息處理與驗證</a></li>
<li><a href="#安全考量與限制">安全考量與限制</a></li>
</ul></li>
</ul></li>
<li><a href="#結論">結論</a></li>
</ul>
<h1 id="前言">前言</h1>
<p>在數位時代，科技公司經常蒐集用戶個人資訊，而 Signal
憑藉其強大的端對端加密（End-to-End Encryption,
E2EE）技術脫穎而出，將用戶隱私放在首位。該應用程式獲得了愛德華·斯諾登（Edward
Snowden）、馬克·祖克柏（Mark Zuckerberg）及伊隆·馬斯克（Elon
Musk）等知名人士的支持，成為重視通訊隱私人士的首選工具。</p>
<h1 id="簡介">簡介</h1>
<p>在典型的即時通訊應用中，用戶透過「可信任」的伺服器進行通訊，伺服器負責接收並轉發訊息。這樣的架構要求用戶對伺服器高度信任，預期其不會濫用或外洩資料。然而，若伺服器遭到入侵，攻擊者可能竊取所有未加密的訊息內容。</p>
<p>Signal
協議是一種開源的端對端加密協議，確保訊息的明文僅存在於通訊雙方的客戶端設備上。即使伺服器被攻擊，攻擊者也無法解密訊息。此外，Signal
協議具備前向安全性（Forward Secrecy）與後向安全性（Backward
Secrecy），確保歷史通訊在密鑰洩露後依然保密。</p>
<h1 id="用戶註冊時的密鑰生成">用戶註冊時的密鑰生成</h1>
<h2
id="迪菲-赫爾曼密鑰交換算法diffie-hellman-key-exchange">迪菲-赫爾曼密鑰交換算法（Diffie-Hellman
Key Exchange）</h2>
<p>要理解 Signal
協議的端對端加密機制，需先瞭解迪菲-赫爾曼密鑰交換算法（Diffie-Hellman
Key Exchange,
DH）。此算法允許雙方在不直接傳輸秘密的情況下，透過公開通道建立共享秘密（Shared
Secret）。其安全性基於離散對數問題（Discrete Logarithm
Problem）的計算困難性。</p>
<p>假設有兩位用戶 Alice 和
Bob，以及一個公開伺服器，伺服器儲存以下兩個參數：</p>
<ul>
<li><strong>g</strong>：一個小的質數，作為生成元（Generator）。</li>
<li><strong>n</strong>：一個非常大的質數（通常為 2000 至 4000
位元），確保計算複雜度。</li>
</ul>
<p>密鑰交換流程如下：</p>
<ol type="1">
<li><strong>生成私鑰（Private Key）</strong>：Alice 和 Bob 各自生成私鑰
<code>a</code> 與 <code>b</code>，其中 <code>1 ≤ x ≤ n</code>。</li>
<li><strong>生成公鑰（Public Key）</strong>：
<ul>
<li>Alice 計算公鑰為 <code>(g ^ a) % n</code></li>
<li>Bob 計算公鑰為 <code>(g ^ b) % n</code></li>
</ul></li>
<li><strong>交換並計算共享秘密</strong>：
<ul>
<li>Alice 使用 Bob 的公鑰計算 <code>((g ^ b) % n) ^ a % n</code></li>
<li>Bob 使用 Alice 的公鑰計算 <code>((g ^ a) % n) ^ b % n</code></li>
</ul></li>
</ol>
<p>由於模冪運算的交換性質，兩者所得結果相同，成為雙方共享的秘密。</p>
<p>以下為 TypeScript 實作範例：</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode typescript"><code class="sourceCode typescript"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">// 假設 g = 11, n = 100（實際應用中 n 應為大質數）</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> g <span class="op">=</span> <span class="dv">11</span><span class="op">;</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> n <span class="op">=</span> <span class="dv">100</span><span class="op">;</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> a <span class="op">=</span> <span class="fu">randomIntFromInterval</span>(<span class="dv">1</span><span class="op">,</span> n)<span class="op">;</span> <span class="co">// Alice 的私鑰</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> b <span class="op">=</span> <span class="fu">randomIntFromInterval</span>(<span class="dv">1</span><span class="op">,</span> n)<span class="op">;</span> <span class="co">// Bob 的私鑰</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> a_key <span class="op">=</span> <span class="fu">modExp</span>(g<span class="op">,</span> a<span class="op">,</span> n)<span class="op">;</span> <span class="co">// Alice 的公鑰</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> b_key <span class="op">=</span> <span class="fu">modExp</span>(g<span class="op">,</span> b<span class="op">,</span> n)<span class="op">;</span> <span class="co">// Bob 的公鑰</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> a_shared_secret <span class="op">=</span> <span class="fu">modExp</span>(b_key<span class="op">,</span> a<span class="op">,</span> n)<span class="op">;</span> <span class="co">// Alice 的共享秘密</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> b_shared_secret <span class="op">=</span> <span class="fu">modExp</span>(a_key<span class="op">,</span> b<span class="op">,</span> n)<span class="op">;</span> <span class="co">// Bob 的共享秘密</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="vs">`共享秘密是否相同：</span><span class="sc">$&#123;</span>a_shared_secret <span class="op">===</span> b_shared_secret<span class="sc">&#125;</span><span class="vs">`</span>)<span class="op">;</span> <span class="co">// true</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">randomIntFromInterval</span>(min<span class="op">:</span> <span class="dt">number</span><span class="op">,</span> max<span class="op">:</span> <span class="dt">number</span>) &#123;</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(<span class="bu">Math</span><span class="op">.</span><span class="fu">random</span>() <span class="op">*</span> (max <span class="op">-</span> min <span class="op">+</span> <span class="dv">1</span>) <span class="op">+</span> min)<span class="op">;</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>&#125;</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">modExp</span>(base<span class="op">:</span> <span class="dt">number</span><span class="op">,</span> exponent<span class="op">:</span> <span class="dt">number</span><span class="op">,</span> modulus<span class="op">:</span> <span class="dt">number</span>) &#123;</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (modulus <span class="op">===</span> <span class="dv">1</span>) <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> result <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>  base <span class="op">=</span> base <span class="op">%</span> modulus<span class="op">;</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (exponent <span class="op">&gt;</span> <span class="dv">0</span>) &#123;</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (exponent <span class="op">%</span> <span class="dv">2</span> <span class="op">===</span> <span class="dv">1</span>) &#123;</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>      result <span class="op">=</span> (result <span class="op">*</span> base) <span class="op">%</span> modulus<span class="op">;</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>    &#125;</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>    exponent <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(exponent <span class="op">/</span> <span class="dv">2</span>)<span class="op">;</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>    base <span class="op">=</span> (base <span class="op">*</span> base) <span class="op">%</span> modulus<span class="op">;</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>  &#125;</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> result<span class="op">;</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>&#125;</span></code></pre></div>
<h2 id="x3dh-密鑰協議extended-triple-diffie-hellman">X3DH
密鑰協議（Extended Triple Diffie-Hellman）</h2>
<h3 id="協議背景與非同步需求">協議背景與非同步需求</h3>
<p>擴展三重迪菲-赫爾曼（Extended Triple Diffie-Hellman,
X3DH）是專為非同步通訊場景設計的密鑰交換協議。傳統 DH
協議要求雙方同時在線，無法滿足現代通訊應用的需求（如用戶可能離線）。X3DH
透過在伺服器上預儲密鑰（Prekeys），允許一方在對方離線時發起安全通訊，實現靈活且安全的初始密鑰協議。</p>
<h3 id="協議參與者與伺服器角色">協議參與者與伺服器角色</h3>
<p>X3DH 涉及三個主要角色：</p>
<ul>
<li><strong>Alice</strong>：訊息發送者，欲向 Bob 發送加密訊息。</li>
<li><strong>Bob</strong>：訊息接收者，提前將密鑰發佈到伺服器。</li>
<li><strong>Signal 伺服器</strong>：作為可信任的中間人，儲存 Bob
的公開密鑰，但無法解密訊息，因訊息採用端到端加密。</li>
</ul>
<p>伺服器的可信任性是協議運作的基礎，若伺服器不可靠，協議可能受到影響，但訊息內容仍因端到端加密而安全。</p>
<h3 id="x3dh-三個主要步驟">X3DH 三個主要步驟</h3>
<p>X3DH 協議分為三個步驟：</p>
<ol type="1">
<li><strong>Bob 發佈密鑰</strong>：Bob
將身份密鑰、簽名預生成密鑰和一次性預生成密鑰上傳至 Signal 伺服器。</li>
<li><strong>Alice 獲取密鑰並發送初始訊息</strong>：Alice 從伺服器獲取
Bob 的密鑰，驗證簽名，計算對稱密鑰，並發送加密的初始訊息。</li>
<li><strong>Bob 接收並處理訊息</strong>：Bob
接收訊息，計算相同的對稱密鑰，驗證訊息來源並解密。</li>
</ol>
<h3 id="密鑰類型與用途">密鑰類型與用途</h3>
<p>當 Bob 註冊 Signal 時，會上傳以下密鑰至伺服器：</p>
<ul>
<li><strong>身份密鑰（Identity Key,
IKB）</strong>：長期公私鑰對，用於身份驗證，僅在私鑰丟失時更新。</li>
<li><strong>簽名預生成密鑰（Signed Prekey,
SPKB）</strong>：中長期公鑰，定期更新（如每週或每月），由身份密鑰簽名以證明真實性。</li>
<li><strong>預密鑰簽名（Sig(IKB, SPKB)）</strong>：用身份私鑰對 SPKB
的簽名，確保密鑰未被篡改。</li>
<li><strong>一次性預生成密鑰（One-Time Prekeys,
OPKB）</strong>：一組僅使用一次的公鑰，帶索引，用後即刪除，增強前向保密。</li>
</ul>
<p>Alice 發送訊息時會生成： - <strong>臨時密鑰（Ephemeral Key,
EKA）</strong>：僅用於當前通訊的短期密鑰，用後即棄。</p>
<h3 id="alice-的密鑰計算與初始訊息">Alice 的密鑰計算與初始訊息</h3>
<p>當 Alice 欲向 Bob 發送訊息時，她執行以下操作：</p>
<ol type="1">
<li><strong>獲取預密鑰包</strong>：從伺服器取得 Bob
的身份密鑰（IKB）、簽名預生成密鑰（SPKB）、預密鑰簽名（Sig）及一組一次性預生成密鑰（OPKB）。</li>
<li><strong>驗證簽名</strong>：使用 Bob 的身份公鑰驗證 SPKB
的簽名，確認密鑰真實性。若驗證失敗，協議繼續但安全性降低。</li>
<li><strong>計算共享密鑰</strong>：Alice 執行四次 DH 計算，得到 KAB（Key
Agreement Result）：</li>
</ol>
<div class="sourceCode" id="cb2"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>DH1 <span class="op">=</span> <span class="fu">DH</span>(IKA<span class="op">,</span> SPKB) <span class="co">// Alice 的身份私鑰與 Bob 的簽名預密鑰</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>DH2 <span class="op">=</span> <span class="fu">DH</span>(EKA<span class="op">,</span> IKB) <span class="co">// Alice 的臨時私鑰與 Bob 的身份公鑰</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>DH3 <span class="op">=</span> <span class="fu">DH</span>(EKA<span class="op">,</span> SPKB) <span class="co">// Alice 的臨時私鑰與 Bob 的簽名預密鑰</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>DH4 <span class="op">=</span> <span class="fu">DH</span>(EKA<span class="op">,</span> OPKB) <span class="co">// Alice 的臨時私鑰與 Bob 的一次性預密鑰（若無 OPKB 則省略）</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>KAB <span class="op">=</span> <span class="fu">KDF</span>(DH1 <span class="op">||</span> DH2 <span class="op">||</span> DH3 <span class="op">||</span> DH4) <span class="co">// 透過密鑰衍生函數生成共享密鑰 KAB</span></span></code></pre></div>
<ol start="4" type="1">
<li><strong>計算關聯數據</strong>：使用 Alice 和 Bob
的身份密鑰生成關聯數據（Associated Data），用於額外認證。</li>
<li><strong>發送初始訊息</strong>：Alice 使用 KAB
加密訊息（Signal會啟用「雙棘輪演算法（Double
Ratchet）」機制加密訊息），並發送以下資訊：
<ul>
<li>她的身份密鑰（IKA）</li>
<li>她的臨時密鑰（EKA）</li>
<li>使用的 OPKB 索引（若有）</li>
<li>關聯數據</li>
<li>加密密文</li>
</ul></li>
<li><strong>刪除中間值</strong>：為安全起見，Alice
刪除所有中間計算值，僅保留 KAB。</li>
</ol>
<table>
<thead>
<tr class="header">
<th>運算</th>
<th>目的</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>DH1、DH2</td>
<td>確保雙方身份驗證</td>
</tr>
<tr class="even">
<td>DH3、DH4</td>
<td>提供前向安全性（DH3 和 DH4 使用短期密鑰）</td>
</tr>
<tr class="odd">
<td>DH4</td>
<td>支援非同步通訊（使用一次性預密鑰，可選）</td>
</tr>
<tr class="even">
<td>KDF</td>
<td>增強密鑰多樣性和安全性（多重 DH 結果串聯）</td>
</tr>
</tbody>
</table>
<img src="/2025/08/04/Understanding-Signal-Protocol-X3DH-Protocol/Key-Generation-Procedure.png" class="">
<ol start="7" type="1">
<li>底下是我整理的 X3DH 總流程圖：</li>
</ol>
<img src="/2025/08/04/Understanding-Signal-Protocol-X3DH-Protocol/X3DH.png" class="">
<h3 id="bob-的訊息處理與驗證">Bob 的訊息處理與驗證</h3>
<p>Bob 接收 Alice 的訊息後：</p>
<ol type="1">
<li>載入自己的私密身份密鑰、簽名預生成密鑰及指定的 OPKB（根據 Alice
提供的索引）。</li>
<li>執行與 Alice 相同的 DH 計算，生成共享密鑰 KAB。</li>
<li>計算關聯數據並與訊息中的關聯數據比較，驗證訊息來源。</li>
<li>使用 KAB 解密密文，若驗證成功，確認訊息來自 Alice。</li>
<li>刪除使用過的 OPKB（從本地和伺服器），確保前向保密。</li>
</ol>
<h3 id="安全考量與限制">安全考量與限制</h3>
<p>X3DH 協議存在以下安全考量：</p>
<ul>
<li><strong>身份驗證問題</strong>：由於無中央證書機構，身份密鑰的真實性需手動驗證（如比對指紋、雜湊值或
QR 碼），操作繁瑣且可能引發人為錯誤。</li>
<li><strong>重放攻擊風險</strong>：若伺服器無一次性預生成密鑰，協議仍可完成，但可能導致重放攻擊或重複計算對稱密鑰，降低前向保密性。</li>
<li><strong>伺服器信任</strong>：協議依賴可信任的伺服器儲存密鑰，若伺服器被攻擊，可能影響協議安全（儘管訊息內容仍安全）。</li>
</ul>
<p>這些問題在 Signal 協議的後續機制（如雙棘輪算法）中得到緩解，超出 X3DH
範圍。</p>
<h1 id="結論">結論</h1>
<p>Signal 協議透過 X3DH
密鑰協議，在公開伺服器的前提下安全建立共享密鑰，實現真正的端對端加密。其前向與後向安全特性使歷史訊息在密鑰洩露後仍能保密。X3DH
平衡了安全性和非同步通訊的便利性，是 Signal、WhatsApp
等通訊平台的核心技術。如需深入了解，可參考 <a
target="_blank" rel="noopener" href="https://signal.org/docs/">Signal 官方文件</a>。</p>

            
        </div>
    </div>
    <div class="post-tags">
        
        <span class="icon">
            <i class="fa-solid fa-tags fa-fw"></i>
        </span>
        
        
        
        <span class="tag">
            
            <a href="/tags/Signal/" style="color: #03a9f4">Signal</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/Encryption/" style="color: #ffa2c4">Encryption</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/X3DH/" style="color: #03a9f4">X3DH</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/Diffie-Hellman/" style="color: #00a596">Diffie-Hellman</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/End-to-End-Encryption/" style="color: #00bcd4">End-to-End Encryption</a>
        </span>
        
    </div>
    <a href="/2025/08/04/Understanding-Signal-Protocol-X3DH-Protocol/" class="go-post">閱讀全文</a>
</div>

<div class="post">
    <a href="/2025/07/24/Building-GitLab-On-Ubuntu-24/">
        <h2 class="post-title">Ubuntu Server 簡單部署 GitLab 社群版</h2>
    </a>
    <div class="category-and-date">
        
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2025/7/24
        </span>
        
        
    </div>
    <div class="description">
        <div class="content" v-pre>
            
            <h1 id="在-ubuntu-24.04-lts-上部署-gitlab-社群版">在 Ubuntu 24.04 LTS
上部署 GitLab 社群版</h1>
<p>最近因為團隊協作需求增加，又不想把程式碼丟到第三方伺服器上，於是決定自己架個
GitLab 來用，這篇文章會一步步帶你把 GitLab 社群版（CE）裝到 Ubuntu 24.04
LTS 上，從硬體需求到安全設定、共享記憶體調整，還有 HTTPS
配置，全部講清楚。</p>
<h2 id="目錄">目錄</h2>
<ul>
<li><a href="#硬體需求一覽">硬體需求一覽</a></li>
<li><a href="#安全性腳本">安全性腳本</a></li>
<li><a href="#重新設定共享記憶體">重新設定共享記憶體</a></li>
<li><a href="#更新系統保持最新">更新系統，保持最新</a></li>
<li><a href="#安裝必要套件">安裝必要套件</a></li>
<li><a href="#加入-gitlab-repository">加入 GitLab Repository</a></li>
<li><a href="#安裝-gitLab-ce">安裝 GitLab CE</a></li>
<li><a href="#找到初始密碼">找到初始密碼</a></li>
<li><a href="#可選https-設定">HTTPS 設定（可選）</a></li>
<li><a href="#總結">總結</a></li>
</ul>
<h2 id="硬體需求一覽">硬體需求一覽</h2>
<p>先確認你的伺服器夠不夠力跑 GitLab：</p>
<table>
<thead>
<tr class="header">
<th>組件</th>
<th>最低要求</th>
<th>建議規格</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>CPU</strong></td>
<td>2 個 vCPU</td>
<td>2–4 個 vCPU</td>
</tr>
<tr class="even">
<td><strong>記憶體</strong></td>
<td>4 GB</td>
<td>6–8 GB</td>
</tr>
<tr class="odd">
<td><strong>硬碟</strong></td>
<td>20–30 GB (SSD)</td>
<td>40–60 GB (SSD)</td>
</tr>
<tr class="even">
<td><strong>系統</strong></td>
<td>Ubuntu 22.04 LTS</td>
<td>Ubuntu 22.04 LTS</td>
</tr>
<tr class="odd">
<td><strong>SWAP</strong></td>
<td>2 GB</td>
<td>2–4 GB</td>
</tr>
</tbody>
</table>
<h2 id="安全性腳本">安全性腳本</h2>
<p>為了讓伺服器安全一點，我們可以先跑安全強化腳本。這裡用我在 GitHub
上發布的一個針對 Ubuntu Server
的腳本，但它會把共享記憶體（SHM）給限制住，從而導致 GitLab 的 PostgreSQL
異常，後面得再調整。</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> clone https://github.com/t2o0n321/linux_server_security.git</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> linux_server_security</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> ./secure_your_server.sh</span></code></pre></div>
<p><strong>小提醒</strong>：如果你是用 root 帳號 SSH 進來的，這腳本會把
root 的 SSH 關掉（安全起見）。所以需要先建個 non-root
帳號，之後用那個來操作。</p>
<p>跑完腳本，記得重開機讓設定生效：</p>
<div class="sourceCode" id="cb2"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> reboot</span></code></pre></div>
<h2 id="重新設定共享記憶體">重新設定共享記憶體</h2>
<p>剛剛在上面提到過，安全腳本會把共享記憶體（SHM）嚴格設定，讓 GitLab 的
PostgreSQL 無法正確運作，所以我們需要先把限制解掉。</p>
<p>先看看 SHM 服務的狀態：</p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> systemctl status set-shm-permissions.service</span></code></pre></div>
<p>會跳出像這樣的資訊：</p>
<div class="sourceCode" id="cb4"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="ex">●</span> set-shm-permissions.service <span class="at">-</span> Set /dev/shm permissions and ownership</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>     <span class="ex">Loaded:</span> loaded <span class="er">(</span><span class="ex">/etc/systemd/system/set-shm-permissions.service</span><span class="kw">;</span> <span class="ex">enabled</span><span class="kw">;</span> <span class="ex">preset:</span> enabled<span class="kw">)</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>     <span class="ex">Active:</span> active <span class="er">(</span><span class="ex">exited</span><span class="kw">)</span> <span class="ex">since</span> Thu 2025-07-24 02:53:16 UTC<span class="kw">;</span> <span class="ex">3h</span> 39min ago</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>   <span class="ex">Main</span> PID: 960 <span class="er">(</span><span class="va">code</span><span class="op">=</span>exited, <span class="va">status</span><span class="op">=</span>0/SUCCESS<span class="kw">)</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>        <span class="ex">CPU:</span> 32ms</span></code></pre></div>
<p>把這服務停掉並禁用：</p>
<div class="sourceCode" id="cb5"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> systemctl stop set-shm-permissions.service</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> systemctl disable set-shm-permissions.service</span></code></pre></div>
<p>然後重新掛載 <code>/dev/shm</code>，把 <code>noexec</code>
移除，給它正確的權限：</p>
<div class="sourceCode" id="cb6"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> mount <span class="at">-o</span> remount,exec,nosuid,nodev /dev/shm</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> chmod 1777 /dev/shm</span></code></pre></div>
<p>檢查一下有沒有設好：</p>
<div class="sourceCode" id="cb7"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mount</span> <span class="kw">|</span> <span class="fu">grep</span> /dev/shm</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ls</span> <span class="at">-ld</span> /dev/shm</span></code></pre></div>
<p>應該會看到：</p>
<div class="sourceCode" id="cb8"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="ex">tmpfs</span> on /dev/shm type tmpfs <span class="er">(</span><span class="ex">rw,nosuid,nodev,size=262144k,inode64</span><span class="kw">)</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="ex">drwxrwxrwt</span> 2 root root 40 Jul 24 06:00 /dev/shm</span></code></pre></div>
<h2 id="更新系統保持最新">更新系統，保持最新</h2>
<p>為了安全，系統需要保持最新狀態：</p>
<div class="sourceCode" id="cb9"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> apt update <span class="kw">&amp;&amp;</span> <span class="fu">sudo</span> apt upgrade <span class="at">-y</span></span></code></pre></div>
<h2 id="安裝必要套件">安裝必要套件</h2>
<p>GitLab 需要一些基本套件，先安裝起來：</p>
<div class="sourceCode" id="cb10"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> apt install <span class="at">-y</span> curl openssh-server ca-certificates tzdata perl</span></code></pre></div>
<h2 id="加入-gitlab-repository">加入 GitLab Repository</h2>
<p>把 GitLab 社群版的 Repo 加到系統裡：</p>
<div class="sourceCode" id="cb11"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> https://packages.gitlab.com/install/repositories/gitlab/gitlab-ce/script.deb.sh <span class="kw">|</span> <span class="fu">sudo</span> bash</span></code></pre></div>
<h2 id="安裝-gitlab-ce">安裝 GitLab CE</h2>
<p>現在我們要開始安裝 GitLab CE，記得把 <code>EXTERNAL_URL</code>
換成你自己的網域：</p>
<div class="sourceCode" id="cb12"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> EXTERNAL_URL=<span class="st">&quot;http://gitlab.example.com&quot;</span> apt install gitlab-ce</span></code></pre></div>
<p>把 <code>gitlab.example.com</code> 換成你真的網域，別直接用這個！</p>
<h2 id="找到初始密碼">找到初始密碼</h2>
<p>裝好後，GitLab 會給你一個 root 帳號的初始密碼：</p>
<div class="sourceCode" id="cb13"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> cat /etc/gitlab/initial_root_password <span class="kw">|</span> <span class="fu">grep</span> Password:</span></code></pre></div>
<p>會看到像這樣：</p>
<div class="sourceCode" id="cb14"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="ex">Password:</span> this_is_your_root_password</span></code></pre></div>
<p>使用 root 帳號登入後，應立刻將 root
的預設密碼改掉，並創建普通使用者帳號來使用。</p>
<p><strong>小提醒</strong>：這密碼只有在沒改過的情況下才能用，而且第一次跑
<code>gitlab-ctl reconfigure</code> 後 24
小時會自動不見。如果登不進去，照 <a
target="_blank" rel="noopener" href="https://docs.gitlab.com/ee/security/reset_user_password.html#reset-your-root-password">GitLab
官方文件</a> 重設密碼。</p>
<h2 id="可選https-設定">（可選）HTTPS 設定</h2>
<p>我們可以加個 HTTPS 讓 GitLab 更安全，首先更改 <code>gitlab.rb</code>
裡面的設定，記得不要用 Append
的方式，確確實實的找到對應的區塊修改，避免錯誤：</p>
<div class="sourceCode" id="cb15"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> nano /etc/gitlab/gitlab.rb</span></code></pre></div>
<p>改這幾行：</p>
<div class="sourceCode" id="cb16"><pre
class="sourceCode ruby"><code class="sourceCode ruby"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>external_url <span class="vs">&#39;https://your_domain&#39;</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>letsencrypt<span class="kw">[</span><span class="vs">&#39;enable&#39;</span><span class="kw">]</span> <span class="kw">=</span> <span class="dv">true</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>letsencrypt<span class="kw">[</span><span class="vs">&#39;contact_emails&#39;</span><span class="kw">]</span> <span class="kw">=</span> <span class="kw">[</span><span class="vs">&#39;you@example_mail.com&#39;</span><span class="kw">]</span></span></code></pre></div>
<p>存檔後，跑重新設定：</p>
<div class="sourceCode" id="cb17"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> gitlab-ctl reconfigure</span></code></pre></div>
<h2 id="總結">總結</h2>
<p>搞定啦，你現在已經在 Ubuntu 24.04 LTS 上把 GitLab
社群版裝好囉！可以用你設定的網域連上去～</p>

            
        </div>
    </div>
    <div class="post-tags">
        
        <span class="icon">
            <i class="fa-solid fa-tags fa-fw"></i>
        </span>
        
        
        
        <span class="tag">
            
            <a href="/tags/gitlab/" style="color: #00a596">gitlab</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/setup/" style="color: #ff7d73">setup</a>
        </span>
        
    </div>
    <a href="/2025/07/24/Building-GitLab-On-Ubuntu-24/" class="go-post">閱讀全文</a>
</div>

<div class="post">
    <a href="/2025/07/13/From-Black-Box-Terminal-to-the-New-Era-of-Programming/">
        <h2 class="post-title">從黑框終端到程式撰寫新世代：Claude Code筆記分享</h2>
    </a>
    <div class="category-and-date">
        
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2025/7/13
        </span>
        
        
    </div>
    <div class="description">
        <div class="content" v-pre>
            
            <h1 id="目錄">目錄</h1>
<ul>
<li><a href="#零前言">零、前言</a></li>
<li><a
href="#一程式撰寫工具的演進從手動到ai助手">一、程式撰寫工具的演進：從手動到AI助手</a></li>
<li><a href="#二實用技巧謀定動三訣">二、實用技巧：謀定動三訣</a>
<ul>
<li><a href="#1-謀把需求講清楚">1. 謀：把需求講清楚</a></li>
<li><a href="#2-定拆解任務">2. 定：拆解任務</a></li>
<li><a href="#3-動快速執行">3. 動：快速執行</a></li>
</ul></li>
<li><a href="#三提示詞技巧簡單最好">三、提示詞技巧：簡單最好</a>
<ul>
<li><a href="#1-啟動深度思考">1. 啟動深度思考</a></li>
<li><a href="#2-用正面表達">2. 用正面表達</a></li>
<li><a href="#3-講清楚標準">3. 講清楚標準</a></li>
<li><a href="#4-處理長文字">4. 處理長文字</a></li>
</ul></li>
<li><a
href="#四ai的極限人工具模型">四、AI的極限：人、工具、模型</a></li>
<li><a
href="#五我的感觸迎接數位時代">五、我的感觸：迎接數位時代</a></li>
<li><a href="#六參考">六、參考</a></li>
</ul>
<h1 id="零前言">零、前言</h1>
<p>最近看了一段關於Claude
Code的分享影片，講者海大介紹了這款AI程式撰寫工具的使用心得。作為對AI工具感興趣的讀者，我被他提到的「黑框終端」吸引——都2025年了，號稱最強的程式撰寫工具居然用命令列介面？這也太復古了吧！雖然我平時用的是Gemini
CLI，但海大的分享讓我對Claude
Code產生好奇，於是整理這篇筆記，分享他的觀點和我的理解，給有興趣的台灣開發者參考。</p>
<p>這篇筆記分五部分：<br />
1. <strong>程式撰寫工具的演進</strong>：從手動寫代碼到AI助手，Claude
Code為何選終端？<br />
2.
<strong>實用技巧</strong>：海大的「謀定動」三訣，效率翻倍的秘訣。<br />
3. <strong>提示詞技巧</strong>：說清楚需求，讓AI更好用。<br />
4.
<strong>AI的極限</strong>：人、工具、模型如何決定程式撰寫的邊界？<br />
5. <strong>我的感觸</strong>：程式設計師的「數位時代」來了！</p>
<h1
id="一程式撰寫工具的演進從手動到ai助手">一、程式撰寫工具的演進：從手動到AI助手</h1>
<p>海大提到，程式撰寫工具的進化就像科技史的縮影。2000年代，程式設計師全靠手動寫代碼，頂多用簡單的自動補全，比如輸入「.」會跳出屬性選項。2018年，TabNine用GPT-2做到整行代碼補全，當時已經很厲害。2022年ChatGPT、2023年GPT-4的出現更是讓人驚嘆，AI寫代碼的能力甚至超越許多專業人士。2024年，AI內建於編輯器，2025年的Claude
Code、Cursor等工具不僅補全代碼，還能理解專案、拆解任務，宛如真正的程式撰寫助手。</p>
<p>Claude
Code最令人意外的是它選擇命令列介面，而非花俏的圖形介面。為什麼？海大解釋有兩個原因：<br />
- <strong>編輯器種類繁多</strong>：程式設計師用的工具各異（VS
Code、Emacs等），命令列是通用的，誰都能用。<br />
-
<strong>圖形介面有侷限</strong>：程式撰寫的核心是感知、規劃、執行，與介面好不好看無關。複雜的UI可能反而限制AI。</p>
<p>命令列的三大優勢是：<br />
-
<strong>自由度高</strong>：能直接使用系統所有功能，不受UI框架限制。<br />
- <strong>操作簡單</strong>：只要說出需求，不用學繁瑣介面。<br />
- <strong>工具相容</strong>：npm、Docker等命令列工具與終端無縫整合。</p>
<p>海大說，Claude
Code雖然看起來陽春，但代碼理解能力超強，效率驚人。它的API額度也很慷慨，一天能用掉價值200美元的token，對資源需求大的開發者來說超划算。</p>
<h1 id="二實用技巧謀定動三訣">二、實用技巧：謀定動三訣</h1>
<p>海大的「謀定動」三訣把AI程式撰寫比喻成開車：先確定目的地（謀），規劃路線（定），然後加速前進（動）。這些技巧簡單卻實用，值得一試。</p>
<h2 id="謀把需求講清楚">1. 謀：把需求講清楚</h2>
<p>需求不清，AI再強也會出錯。海大的方法是：<br />
-
<strong>多討論</strong>：跟AI反覆溝通，確保自己的思路清晰，AI也能找出邏輯漏洞。<br />
-
<strong>請AI重述</strong>：讓AI把需求複述一遍，確認雙方理解一致，出錯時好追蹤原因。</p>
<p>例如，做一個待辦清單（Todo
List），需求是「支援新增、刪除、標記完成」，跟AI討論後可能會發現忘了提到資料儲存方式。海大說，講清楚需求能減少80%的重工，這點對新手尤其重要。</p>
<h2 id="定拆解任務">2. 定：拆解任務</h2>
<p>需求確認後，讓AI制定執行計劃。比如說：「根據需求，列出任務計劃，標出哪些可以同時進行。」AI會給出清單，像先定資料結構、再寫前端介面。有了計劃，後續執行就順暢許多。</p>
<h2 id="動快速執行">3. 動：快速執行</h2>
<p>計劃好後，讓AI全速生成代碼。如果出錯：<br />
- <strong>喊停重來</strong>：按Ctrl+C終止，重新輸入需求。<br />
- <strong>小修小補</strong>：小問題就補充指令，AI會自行調整。<br />
-
<strong>清記憶</strong>：AI偶爾會「卡住」，用類似<code>clear</code>的指令重置。</p>
<p>其他實用建議：<br />
- 用<code>git</code>生成專案上下文檔案，幫助AI記錄背景。<br />
- 為AI寫專用註解，讓它更懂你的意圖。<br />
-
常用命令（如啟動前端、檢查錯誤訊息）可存起來重複用，或自訂指令省時間。<br />
- 新手建議用現成框架（像React腳手架），少走冤枉路。</p>
<h1 id="三提示詞技巧簡單最好">三、提示詞技巧：簡單最好</h1>
<p>海大強調，提示詞不用搞得太複雜，關鍵是<strong>講清楚</strong>。Claude
Code很聰明，簡單的表達效果最好，繁瑣的指令反而可能誤導。</p>
<h2 id="啟動深度思考">1. 啟動深度思考</h2>
<p>對AI說「認真思考再回答」，能啟動類似Claude
Code的<code>thinker</code>功能，讓答案更精準。例如：「分析待辦清單的代碼，找出效能瓶頸並優化。」AI會分步拆解問題，結果更可靠。如果回應太慢，搭配「分步思考」（列出步驟），能減少超時問題。</p>
<h2 id="用正面表達">2. 用正面表達</h2>
<p>說「要做什麼」比「不要做什麼」有效。例如：<br />
- 不要這樣：不要用弱型別、不要寫重複代碼。<br />
- 要這樣：用TypeScript明確型別、把共用邏輯寫成函式。</p>
<p>正面表達能讓AI清楚方向，減少混淆。</p>
<h2 id="講清楚標準">3. 講清楚標準</h2>
<p>提前說明要求，比如：「我要一個待辦清單，支援所有合法輸入，代碼要簡潔、可維護。如果需求不合理，直接說。」這能避免AI寫出敷衍的代碼。</p>
<h2 id="處理長文字">4. 處理長文字</h2>
<p>分析錯誤訊息時，先貼訊息，再寫指令。例如：「根據以上錯誤訊息，找出程式當掉的原因並給解法。」指令放後面，AI理解更準。</p>
<h1 id="四ai的極限人工具模型">四、AI的極限：人、工具、模型</h1>
<p>海大用「人-工具-模型」框架分析AI程式撰寫的極限，很有啟發：<br />
1. <strong>模型</strong>：決定AI的能力上限。像Claude
Code或Gemini這樣的頂尖模型若無法實現某代碼，當前技術就無解。<br />
2. <strong>工具</strong>：Claude
Code這類工具是模型的外殼，負責優化互動和專案管理。它的命令列設計簡單但高效。<br />
3. <strong>人</strong>：程式設計師有三個角色：<br/> -
定義者：清楚表達需求。<br />
- 審查者：檢查代碼品質和邏輯。<br />
- 創作者：架構設計和創新算法仍需人類智慧。</p>
<p>AI擅長寫基本功能、改進代碼、生成測試和文件，但突破性創新還得靠人。這個框架讓我更明白如何善用AI工具。</p>
<h1 id="五我的感觸迎接數位時代">五、我的感觸：迎接數位時代</h1>
<p>海大提到Claude
Code宕機時，他手寫代碼花了20多分鐘才完成10分鐘的功能，還想讓AI檢查。這讓我想到自己寫代碼時，總會不自覺想問AI「這段OK嗎」。AI已經悄悄改變了我們的習慣。</p>
<p>他把這比喻成從「底片時代」到「數位時代」。底片時代，攝影師每按快門都小心翼翼，底片珍貴，構圖全靠經驗。數位時代，記憶卡讓你隨意拍，重點是挑選好照片和後製。程式撰寫也一樣：以前每行代碼都要深思熟慮，現在AI生成多個版本，我們挑最好的、快速調整，核心能力變成寫好提示詞和辨別好代碼。</p>
<p>基礎原理還是很重要，但AI讓我能專注在更高層的邏輯和創意。這種改變有點不適應，卻也充滿機會——程式撰寫變得更輕鬆，讓我們能把心力放在更有趣的事情上。Claude
Code的終端設計雖然復古，但效率驚人，改天真想試試看！</p>
<h1 id="六參考">六、參考</h1>
<ul>
<li><a
target="_blank" rel="noopener" href="https://youtu.be/sOvi9Iu1Dq8?si=R6PpKZIZ0QGZ9j_4">海大的影片</a></li>
</ul>

            
        </div>
    </div>
    <div class="post-tags">
        
        <span class="icon">
            <i class="fa-solid fa-tags fa-fw"></i>
        </span>
        
        
        
        <span class="tag">
            
            <a href="/tags/vibe-coding/" style="color: #00a596">vibe-coding</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/AI/" style="color: #03a9f4">AI</a>
        </span>
        
    </div>
    <a href="/2025/07/13/From-Black-Box-Terminal-to-the-New-Era-of-Programming/" class="go-post">閱讀全文</a>
</div>

<div class="post">
    <a href="/2025/06/25/bitcoin-whitepaper/">
        <h2 class="post-title">Bitcoin White Paper</h2>
    </a>
    <div class="category-and-date">
        
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2025/6/25
        </span>
        
        
    </div>
    <div class="description">
        <div class="content" v-pre>
            
            <h1 id="bitcoin-white-paper">Bitcoin White Paper</h1>
<blockquote>
<p><a
target="_blank" rel="noopener" href="https://github.com/cypherpunks-core/bitcoin_whitepaper_zh">https://github.com/cypherpunks-core/bitcoin_whitepaper_zh</a>
<br/> <a
target="_blank" rel="noopener" href="https://peterpowerfullife.com/blog/satoshi-nakamoto-electronic-cash-white-paper/">https://peterpowerfullife.com/blog/satoshi-nakamoto-electronic-cash-white-paper/</a></p>
</blockquote>
<p>這邊會從我的學習筆記簡單介紹比特幣的白皮書，如果需要更細節的內容，可以看我在
notion 發布的筆記文章喔：</p>
<blockquote>
<p><a
target="_blank" rel="noopener" href="https://t2o0n321-note.notion.site/Bitcoin-White-Paper-2035a22fbd8d80f3aa78d55e6909224d?pvs=73">https://t2o0n321-note.notion.site/Bitcoin-White-Paper-2035a22fbd8d80f3aa78d55e6909224d?pvs=73</a></p>
</blockquote>
<h1 id="目錄">目錄</h1>
<ol type="1">
<li><a href="#一簡介">簡介</a></li>
<li><a href="#二交易transaction-tx">交易（Transaction, TX）</a></li>
<li><a href="#三時間戳伺服器timestamp-server">時間戳伺服器（Timestamp
Server）</a></li>
<li><a href="#四工作量證明proof-of-work-pow">工作量證明（Proof of Work,
PoW）</a></li>
<li><a href="#五網路-network">網路 (Network)</a></li>
<li><a href="#六獎勵-incentive">獎勵 (Incentive)</a></li>
<li><a
href="#七回收硬碟空間reclaiming-disk-space">回收硬碟空間（Reclaiming
Disk Space）</a></li>
<li><a
href="#八簡化版支付確認-simplified-payment-verification-spv">簡化版支付確認
(Simplified Payment Verification, SPV)</a></li>
<li><a
href="#九價值的組合與分割-combining-and-splitting-value">價值的組合與分割
(Combining and Splitting Value)</a></li>
<li><a href="#十隱私-privacy">隱私 (Privacy)</a></li>
<li><a href="#十一計算-calculations">計算 (Calculations)</a></li>
</ol>
<hr />
<h1 id="一簡介">一、簡介</h1>
<p>你有沒有發現，現在網路上的金錢交易，幾乎都要靠銀行或第三方支付公司來幫忙？這些金融機構就像是大家都要信任的「中間人」，幫我們處理每一筆轉帳或付款。</p>
<p>但這樣的做法，其實有不少小麻煩：</p>
<ol type="1">
<li><strong>一定要信任中間人</strong>：
<ul>
<li>不管你是買東西還是收錢，都得相信銀行或支付公司會幫你把錢處理好。</li>
</ul></li>
<li><strong>交易可能被取消</strong>：
<ul>
<li>有時候，明明已經付錢了，卻還是有可能被退回或撤銷，像是信用卡爭議、詐騙等。</li>
<li>這讓賣家很不安心，怕收到錢後又被追回。</li>
</ul></li>
<li><strong>手續費和麻煩多</strong>：
<ul>
<li>因為要防止糾紛，銀行常常會要求你提供很多資料，流程也變得複雜，還要收手續費。</li>
</ul></li>
<li><strong>線上交易不夠「像現金」</strong>：
<ul>
<li>在現實生活中，現金交易是「一手交錢一手交貨」，沒有人能反悔。但網路上，這種「不可逆」的感覺很難做到。</li>
</ul></li>
</ol>
<p>所以，大家一直在想，有沒有可能發明一種「不用信任中間人」的網路金錢？</p>
<p>理想的電子支付系統，應該要：</p>
<ul>
<li>讓雙方直接交易，不用靠銀行背書。</li>
<li>交易一旦完成就不能反悔，保護賣家。</li>
<li>能防止「一筆錢花兩次」這種作弊（雙重支付）。</li>
<li>整個系統要夠安全，只要大多數人是誠實的，壞人就很難搞破壞。</li>
</ul>
<hr />
<h1 id="二交易transaction-tx">二、交易（Transaction, TX）</h1>
<h2 id="虛擬貨幣的基本玩法">虛擬貨幣的基本玩法</h2>
<ol type="1">
<li><strong>什麼是電子貨幣？</strong>
<ul>
<li>你可以把電子貨幣想像成一條「簽名接力棒」。每次有人把錢轉給別人，就在這條接力棒上加一個自己的簽名。</li>
<li>這樣，每一筆錢的來龍去脈都查得到，誰給誰、什麼時候，都有記錄。</li>
</ul></li>
<li><strong>怎麼轉帳？</strong>
<ul>
<li>假設你要把手上的比特幣轉給朋友，你會：
<ul>
<li>把上一次收到這筆錢的紀錄（hash）和朋友的「收款帳號」（公鑰）寫在一起。</li>
<li>用自己的「私鑰」簽名，證明這筆錢真的屬於你。</li>
</ul></li>
<li>這樣一來，朋友收到後，也能查到這筆錢的歷史，確定沒問題。</li>
</ul></li>
</ol>
<img src="/2025/06/25/bitcoin-whitepaper/image.png" class="">
<ol start="3" type="1">
<li><strong>怎麼驗證？</strong>
<ul>
<li>收到錢的人，只要檢查這條「簽名接力棒」上的每一個簽名，就能確定這筆錢沒被亂改，也真的屬於轉帳的人。</li>
</ul></li>
</ol>
<h2 id="雙重支付的問題">雙重支付的問題</h2>
<ol type="1">
<li><strong>什麼是雙重支付？</strong>
<ul>
<li>因為電子資料很容易複製，有些人可能會想「一筆錢花兩次」。</li>
<li>這就像你把同一張百元鈔票影印兩份，分別給兩個人，這在現實世界當然不行，但在網路上卻很難防。</li>
</ul></li>
<li><strong>傳統解法：找個公正的「鑄幣廠」</strong>
<ul>
<li>以前的做法，是找一個大家都信任的「鑄幣廠」（有點像銀行），每一筆交易都要經過它來檢查。</li>
<li>只要鑄幣廠說OK，這筆錢才算真的轉手。</li>
<li>但這樣一來，整個系統就又回到「要信任中間人」的老問題。</li>
</ul></li>
</ol>
<h2 id="去中心化的想法">去中心化的想法</h2>
<ol type="1">
<li><strong>大家一起監督</strong>
<ul>
<li>如果我們不想靠單一的鑄幣廠，那就要讓所有人都能看到每一筆交易的歷史。</li>
<li>這樣，大家可以一起確認，這筆錢是不是第一次被花出去。</li>
</ul></li>
<li><strong>共識很重要</strong>
<ul>
<li>要做到這一點，系統必須有辦法讓大家對「哪一筆交易是最早的」達成共識，這樣才能防止有人作弊。</li>
</ul></li>
</ol>
<hr />
<h1 id="三時間戳伺服器timestamp-server">三、時間戳伺服器（Timestamp
Server）</h1>
<p>你可以把「時間戳伺服器」想像成一個公開的日記本，大家都能在上面寫下「我在某個時間點做了什麼事」。</p>
<ol type="1">
<li><strong>時間戳伺服器是什麼？</strong>
<ul>
<li>它會把一堆交易（像一頁日記）做成一個「雜湊」（hash），然後標記上時間，公開給大家看。</li>
<li>這就像你把一張照片貼到網路論壇，證明「這張照片在某個時間點就已經存在了」。</li>
</ul></li>
<li><strong>為什麼要這樣做？</strong>
<ul>
<li>這樣可以證明，這些交易在那個時間點之前就已經發生，沒有人能事後偷偷改掉。</li>
</ul></li>
<li><strong>怎麼串成一條鏈？</strong>
<ul>
<li>每一個新的時間戳，裡面都會包含前一個時間戳的雜湊，這樣就像一條「日記鏈」一樣，一環扣一環。</li>
<li>如果有人想改過去的紀錄，就必須把後面所有的日記都重寫，這幾乎是不可能的。</li>
</ul></li>
</ol>
<hr />
<h1 id="四工作量證明proof-of-work-pow">四、工作量證明（Proof of Work,
PoW）</h1>
<ol type="1">
<li><strong>什麼是工作量證明？</strong>
<ul>
<li>你可以把它想像成一個「解謎比賽」。</li>
<li>每個人都在搶著解出一個很難的謎題（就是找到一個特定的數字，讓整個區塊的雜湊值有很多個0開頭）。</li>
<li>誰先解出來，誰就有權利把這一頁日記（區塊）寫進區塊鏈。</li>
</ul></li>
<li><strong>為什麼要這麼麻煩？</strong>
<ul>
<li>這樣做的好處是，大家都要花力氣（算力）來參與，沒有人能輕易作弊。</li>
<li>只要大多數人是誠實的，壞人就算想作弊，也要付出比別人更多的努力，幾乎不可能成功。</li>
</ul></li>
<li><strong>怎麼驗證？</strong>
<ul>
<li>驗證很簡單，只要檢查這個答案（雜湊值）是不是有夠多的0開頭就好。</li>
<li>所以「解題」很難，「驗證」卻很快。</li>
</ul></li>
<li><strong>比喻一下</strong>：
<ul>
<li>想像你和朋友玩猜數字遊戲，規則是「誰先猜到一個讓答案開頭有5個0的數字就贏」。</li>
<li>你可能要猜很多次才會中，但只要中一次，大家一看就知道你對了。</li>
</ul></li>
<li><strong>保護區塊鏈的秘密武器</strong>：
<ul>
<li>工作量證明讓每一個區塊都很難被改動。</li>
<li>如果有人想改過去的區塊，不只要重做那個區塊的謎題，還要把後面所有的謎題都重新解過，這幾乎是不可能的。</li>
</ul></li>
<li><strong>難度會調整</strong>：
<ul>
<li>如果大家解謎太快，系統就會自動把謎題變難，讓平均每10分鐘才會有一個人解出來。</li>
<li>這樣可以確保區塊鏈的成長速度穩定，不會一下子暴衝。</li>
</ul></li>
</ol>
<hr />
<h1 id="五網路-network">五、網路 (Network)</h1>
<p>你可以把比特幣的網路想像成一個大家都能參加的「大群組」，每個人都可以看到最新的交易消息，也都能參與維護這個系統。</p>
<p>比特幣網路的運作流程，其實就像一場大家一起參加的「記帳遊戲」：</p>
<ol type="1">
<li><strong>新交易廣播給所有人</strong>
<ul>
<li>每當有人發送比特幣（像是A轉1顆比特幣給B），這筆交易就會被「大聲宣布」給所有節點知道。</li>
<li>每個節點都會把這筆交易暫時放進自己的「記憶池」（mempool），等著打包。</li>
</ul></li>
<li><strong>大家收集交易、組成區塊</strong>
<ul>
<li>節點（尤其是礦工）會從記憶池裡挑選還沒被打包的交易，組成一個「候選區塊」。</li>
<li>這就像大家把還沒送出去的包裹裝進一個大箱子，準備進行下一步——挖礦。</li>
</ul></li>
<li><strong>開始解謎（挖礦）</strong>
<ul>
<li>每個礦工都會為這個候選區塊進行「工作量證明」（Proof of
Work），也就是拼命猜數字，直到找到一個讓區塊雜湊值夠難的答案。</li>
</ul></li>
<li><strong>有人解出謎題就廣播新區塊</strong>
<ul>
<li>一旦有礦工成功解出謎題，就會馬上把這個新區塊「大聲宣布」給全網。</li>
<li>區塊裡包含一堆交易、前一個區塊的雜湊、時間戳記、nonce等。</li>
</ul></li>
<li><strong>大家檢查新區塊是否合格</strong>
<ul>
<li>其他節點收到新區塊後，會檢查裡面的每一筆交易是不是有效，有沒有雙重支付，區塊本身的結構和工作量證明對不對。</li>
<li>只有全部通過檢查，這個區塊才會被大家接受。</li>
</ul></li>
<li><strong>大家以這個區塊為基礎繼續挖礦</strong>
<ul>
<li>如果節點認可這個區塊，就會以它為基礎繼續挖下一個區塊。</li>
<li>這個行為也像是在「投票」：代表「我認同這個區塊，因為我以它為基礎繼續努力」。</li>
</ul></li>
</ol>
<aside>
<h3 id="總結流程串起來就是">總結流程串起來就是：</h3>
<ol type="1">
<li>新交易發送出來，全網知道。</li>
<li>礦工收集交易、組區塊。</li>
<li>礦工開始 PoW 挖礦。</li>
<li>有人挖到就廣播。</li>
<li>其他節點驗證後接受。</li>
<li>所有人就從這個區塊繼續往下挖。</li>
</ol>
</aside>
<hr />
<h1 id="六獎勵-incentive">六、獎勵 (Incentive)</h1>
<p>你可能會好奇：「這麼多人願意花電力、時間來幫忙維護比特幣網路，他們到底圖什麼？」</p>
<p>其實，比特幣設計了一套很聰明的獎勵機制，讓大家有動力參與：</p>
<ol type="1">
<li><strong>挖礦獎勵：新比特幣的誕生</strong>
<ul>
<li>每個區塊的第一筆交易叫做「創幣交易」（coinbase
transaction），這筆交易會「從無到有」產生新的比特幣，直接給挖到這個區塊的礦工。</li>
<li>這就像黃金系統：誰挖到就是誰的，但你得付出努力（電力、時間）才挖得到。</li>
</ul></li>
<li><strong>交易手續費也是獎勵</strong>
<ul>
<li>除了新幣，每筆交易如果有多餘的錢沒轉出去（輸入大於輸出），這些差額就會變成手續費，歸打包區塊的礦工所有。</li>
<li>這讓礦工即使未來新幣越來越少，還是有收入來源。</li>
</ul></li>
<li><strong>新幣會越來越少，最終只靠手續費</strong>
<ul>
<li>比特幣總量有限（2100萬顆），每隔約四年，挖礦獎勵就會「減半」。</li>
<li>最後新幣發完，礦工就只能靠手續費維生。</li>
</ul></li>
<li><strong>誠實比作弊更有利</strong>
<ul>
<li>比特幣的獎勵設計，讓誠實參與比作弊更划算。</li>
<li>如果你有很多算力，與其花力氣作弊，不如老老實實挖礦，這樣每10分鐘就能穩定拿到獎勵和手續費，長期下來更賺。</li>
</ul></li>
</ol>
<aside>
<blockquote>
<p>💡 獎勵機制 = 幣的分發 + 鼓勵誠實 + 阻止攻擊</p>
</blockquote>
比特幣不是靠法律強制大家守規矩，而是用經濟誘因讓誠實行為自然而然發生，這就是它去中心化的根本。
</aside>
<hr />
<h1
id="七回收硬碟空間reclaiming-disk-space">七、回收硬碟空間（Reclaiming
Disk Space）</h1>
<p>你可能會想：「比特幣區塊鏈這麼大，會不會有一天硬碟裝不下？」</p>
<p>其實，比特幣有一個很聰明的設計，讓你不用一直存下所有的細節資料：</p>
<ol type="1">
<li><strong>哪些資料可以刪？</strong>
<ul>
<li>如果一枚比特幣的最新交易已經被很多區塊覆蓋（也就是說，這筆錢已經被花出去很久了），那麼它之前的交易歷史就可以放心刪掉。</li>
<li>這就像你把舊收據丟掉，只保留最新的帳本紀錄。</li>
</ul></li>
<li><strong>怎麼刪又不會壞掉？</strong>
<ul>
<li>這裡用到一個叫「Merkle Tree（梅克爾樹）」的技術。</li>
<li>所有交易會被組成一棵樹，最上面的「樹根」（Merkle
Root）會放進區塊頭裡。</li>
<li>只要樹根沒變，就算你把底下的某些枝葉（舊交易細節）砍掉，整個區塊的驗證還是成立。</li>
</ul></li>
<li><strong>只存區塊頭就夠了嗎？</strong>
<ul>
<li>其實只要存下每個區塊的「區塊頭」（Header），就能追蹤整條鏈的歷史。</li>
<li>一個區塊頭大約80
bytes，一年下來也才幾MB，對現代電腦來說根本不痛不癢。</li>
<li>這種「輕節點」（SPV節點）就算硬碟小，也能參與比特幣網路。</li>
</ul></li>
<li><strong>摩爾定律的幫忙</strong>
<ul>
<li>電腦硬體越來越進步，區塊鏈資料的成長速度其實遠比硬碟容量慢，所以不用太擔心。</li>
</ul></li>
</ol>
<hr />
<h1
id="八簡化版支付確認-simplified-payment-verification-spv">八、簡化版支付確認
(Simplified Payment Verification, SPV)</h1>
<p>有些人會問：「我不想下載整條區塊鏈，只想知道自己收到的比特幣有沒有被確認，行不行？」</p>
<p>答案是：可以！這就是「簡化版支付確認」（SPV）的用意。</p>
<ol type="1">
<li><strong>SPV怎麼運作？</strong>
<ul>
<li>你只需要三樣東西：
<ul>
<li>最長的區塊鏈「區塊頭」列表（很小很輕）。</li>
<li>你那筆交易的「Merkle分支」（證明這筆交易真的在某個區塊裡）。</li>
<li>這筆交易被打包進哪個區塊的時間戳。</li>
</ul></li>
<li>這樣你就能確認：
<ul>
<li>有完整節點曾經打包這筆交易。</li>
<li>這個區塊是目前最長鏈的一部分。</li>
<li>隨著後面區塊越來越多，你的交易就越安全。</li>
</ul></li>
</ul></li>
<li><strong>SPV的好處</strong>
<ul>
<li>不用下載整條區塊鏈，手機、平板也能輕鬆驗證收款。</li>
<li>很多行動錢包、輕錢包（像Electrum、Trust
Wallet）都是用這種方式。</li>
</ul></li>
<li><strong>SPV的風險</strong>
<ul>
<li>SPV的安全性還是要靠大多數節點是誠實的。</li>
<li>如果遇到壞人掌控大部分網路（像51%攻擊），SPV用戶有可能被騙。</li>
<li>不過一旦發現有可疑，SPV用戶可以選擇下載完整區塊來自己驗證。</li>
</ul></li>
</ol>
<hr />
<h1
id="九價值的組合與分割-combining-and-splitting-value">九、價值的組合與分割
(Combining and Splitting Value)</h1>
<p>你有沒有想過，比特幣怎麼「找零」？怎麼把一大筆錢拆開來用，或把零錢湊一湊付出去？</p>
<p>比特幣的「找零」和現金很像，這一切都靠一個叫「UTXO」的設計。</p>
<ol type="1">
<li><strong>什麼是UTXO？</strong>
<ul>
<li>UTXO就是「尚未花費的交易輸出」（Unspent Transaction Output）。</li>
<li>你可以把它想像成一張張「找零券」或「現金券」，每一張都記錄著金額和歸屬。</li>
</ul></li>
<li><strong>怎麼組合和分割？</strong>
<ul>
<li>假設Alice有三張UTXO：2 BTC、3 BTC、1 BTC。</li>
<li>她要付5 BTC給Bob，就可以把2 BTC和3
BTC這兩張「現金券」一起用掉。</li>
<li>如果她用超過的金額（比如2+3+4=9 BTC），多出來的4
BTC就會自動找零，變成一張新的UTXO回到她自己手上。</li>
</ul></li>
<li><strong>每次收錢都會產生新的UTXO</strong>
<ul>
<li>Bob收到5 BTC後，這5 BTC就會變成他錢包裡的一張新UTXO。</li>
<li>以後他要付錢，也會用這張UTXO當作「現金券」來花。</li>
</ul></li>
<li><strong>為什麼要這樣設計？</strong>
<ul>
<li>這種方式讓比特幣交易可以靈活組合、分割，就像現金一樣方便。</li>
<li>也讓系統更容易防止雙重支付，因為每張UTXO只能花一次。</li>
<li>而且每一筆UTXO都能追蹤來源，讓整個系統更透明。</li>
</ul></li>
<li><strong>和傳統帳戶有什麼不同？</strong>
<ul>
<li>傳統銀行帳戶是「一個帳戶一個餘額」，比特幣則是「一堆UTXO加起來就是你的總額」。</li>
<li>這樣做可以讓交易更容易並行處理，也比較不容易出現爭議。</li>
</ul></li>
</ol>
<hr />
<h1 id="十隱私-privacy">十、隱私 (Privacy)</h1>
<p>你可能會問：「比特幣不是公開透明嗎？那我的隱私怎麼辦？」</p>
<p>其實，比特幣的隱私設計很有巧思，它不是完全匿名，而是「偽匿名」——
也就是說，大家看得到交易紀錄，但看不到真實身份。</p>
<ol type="1">
<li><strong>怎麼保護隱私？</strong>
<ul>
<li>每個人用的是「公鑰」或「地址」來收發比特幣，這些地址不會直接顯示你的名字。</li>
<li>你可以每次交易都用新的地址，這樣別人就很難把所有交易都連到你身上。</li>
<li>這有點像股票市場的「號碼牌」，大家只看到號碼，不知道背後是誰。</li>
</ul></li>
<li><strong>隱私的限制</strong>
<ul>
<li>如果你在交易所用過KYC（身份認證），那麼這個地址就有可能被追蹤到你本人。</li>
<li>如果一筆交易有多個輸入，這些輸入很可能都屬於同一個人，這也可能被分析出來。</li>
</ul></li>
<li><strong>怎麼提升隱私？</strong>
<ul>
<li>最簡單的方法就是每次收款都用新地址，盡量不要重複使用同一個地址。</li>
<li>也可以用混幣服務（像CoinJoin）來增加隱私。</li>
</ul></li>
<li><strong>比特幣的隱私意義</strong>
<ul>
<li>用戶可以不用靠銀行或政府，也能保有一定程度的財務隱私。</li>
<li>這種設計也啟發了後來的隱私幣（像Monero、Zcash）和各種混幣技術。</li>
</ul></li>
</ol>
<hr />
<h1 id="十一計算-calculations">十一、計算 (Calculations)</h1>
<p>你可能會好奇，比特幣怎麼用數學來保證安全？這裡有個很有趣的概念叫「隨機漫步」，我們用生活化的方式來解釋：</p>
<ol type="1">
<li><strong>什麼是隨機漫步？</strong>
<ul>
<li>想像你站在一條直線上，每次丟硬幣，正面就往右走一步，反面就往左走一步。</li>
<li>每一步都是隨機的，走到哪裡完全看運氣，這就叫「隨機漫步」。</li>
<li>這種走法有個特點：你未來會走到哪裡，只跟你現在的位置有關，跟你怎麼走到這裡來沒關係（這叫「無記憶性」）。</li>
</ul></li>
<li><strong>比特幣怎麼用這個概念？</strong>
<ul>
<li>在比特幣裡，誠實的礦工和攻擊者就像在比賽誰先走到終點。</li>
<li>誠實礦工每挖出一個區塊，就往前一步；攻擊者每挖出一個區塊，也往前一步。</li>
<li>只要誠實礦工的「步數」比攻擊者多，整個系統就很安全。</li>
</ul></li>
<li><strong>雙重支付的攻擊機率</strong>
<ul>
<li>假設攻擊者想要「重花」一筆錢，他必須自己偷偷挖一條比誠實礦工還長的區塊鏈。</li>
<li>但只要大多數算力在誠實礦工手上，攻擊者每落後一個區塊，追上的機率就會指數級下降。</li>
<li>這就像你和朋友賽跑，每落後一步，要追上就越難。</li>
</ul></li>
<li><strong>等幾個確認才安全？</strong>
<ul>
<li>比特幣建議，收到一筆大額交易時，最好等6個區塊確認（大約1小時），這樣攻擊者想要追上就幾乎不可能。</li>
<li>小額交易可以等少一點，根據風險自己決定。</li>
</ul></li>
<li><strong>數學公式（給有興趣的人）</strong>
<ul>
<li>白皮書裡有一個計算攻擊成功機率的公式，基本上就是用「卜瓦松分布」來算。</li>
<li>只要攻擊者的算力不是大多數，等的區塊越多，安全性就越高。</li>
</ul></li>
</ol>
<hr />
<p>這樣，比特幣就用簡單的數學和機率，讓大家可以放心地在網路上用「去中心化」的方式交易，不怕被作弊！</p>

            
        </div>
    </div>
    <div class="post-tags">
        
        <span class="icon">
            <i class="fa-solid fa-tags fa-fw"></i>
        </span>
        
        
        
        <span class="tag">
            
            <a href="/tags/crypto-currencies/" style="color: #ffa2c4">crypto-currencies</a>
        </span>
        
    </div>
    <a href="/2025/06/25/bitcoin-whitepaper/" class="go-post">閱讀全文</a>
</div>

<div class="post">
    <a href="/2025/06/25/setup-copypasteme-guide/">
        <h2 class="post-title">CopyPaste.me Full Setup Guide</h2>
    </a>
    <div class="category-and-date">
        
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2025/6/25
        </span>
        
        
    </div>
    <div class="description">
        <div class="content" v-pre>
            
            <h2 id="目錄">目錄</h2>
<ol type="1">
<li><a href="#1-系統更新">系統更新</a></li>
<li><a href="#2-裝-nodejs">裝 Node.js</a></li>
<li><a href="#3-裝-mongodb-80">裝 MongoDB 8.0</a></li>
<li><a href="#4-裝-php">裝 PHP</a></li>
<li><a href="#5-拉專案下來">拉專案下來</a></li>
<li><a href="#6-裝-node-依賴">裝 Node 依賴</a></li>
<li><a href="#7-設定專案">設定專案</a></li>
<li><a href="#8-搞定-mongodb-資料庫">搞定 MongoDB 資料庫</a></li>
<li><a href="#9-加個-ssl-選用">加個 SSL (選用)</a></li>
<li><a href="#10-建置前端">建置前端</a></li>
<li><a href="#11-啟動後端">啟動後端</a></li>
<li><a href="#12-跑前端">跑前端</a></li>
<li><a href="#13-設成服務-選用">設成服務 (選用)</a></li>
<li><a href="#14-遇到問題">遇到問題？</a></li>
<li><a href="#15-小撇步">小撇步</a></li>
</ol>
<hr />
<h2 id="系統更新">1. 系統更新</h2>
<p>先把系統弄乾淨，確保套件都是最新的。Ubuntu 直接敲這兩行：</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> apt update <span class="kw">&amp;&amp;</span> <span class="fu">sudo</span> apt upgrade <span class="at">-y</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> apt install <span class="at">-y</span> build-essential python3</span></code></pre></div>
<p>macOS 就用 Homebrew 更新吧，應該不用我多說，你懂的！</p>
<hr />
<h2 id="裝-node.js">2. 裝 Node.js</h2>
<p>用 <strong>nvm</strong> 裝 Node.js，這樣切版本超方便。</p>
<h3 id="a.-裝-nvm">a. 裝 nvm</h3>
<div class="sourceCode" id="cb2"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-o-</span> https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.7/install.sh <span class="kw">|</span> <span class="fu">bash</span></span></code></pre></div>
<p>裝完後，把這段加到你的 <code>~/.bashrc</code> 或
<code>~/.zshrc</code>：</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="bu">export</span> <span class="va">NVM_DIR</span><span class="op">=</span><span class="st">&quot;</span><span class="va">$(</span><span class="bu">[</span> <span class="ot">-z</span> <span class="st">&quot;</span><span class="va">$&#123;XDG_CONFIG_HOME</span><span class="op">-</span><span class="va">&#125;</span><span class="st">&quot;</span> <span class="bu">]</span> <span class="kw">&amp;&amp;</span> <span class="bu">printf</span> %s <span class="st">&quot;</span><span class="va">$&#123;HOME&#125;</span><span class="st">/.nvm&quot;</span> <span class="kw">||</span> <span class="bu">printf</span> %s <span class="st">&quot;</span><span class="va">$&#123;XDG_CONFIG_HOME&#125;</span><span class="st">/nvm&quot;</span><span class="va">)</span><span class="st">&quot;</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="bu">[</span> <span class="ot">-s</span> <span class="st">&quot;</span><span class="va">$NVM_DIR</span><span class="st">/nvm.sh&quot;</span> <span class="bu">]</span> <span class="kw">&amp;&amp;</span> <span class="ex">\.</span> <span class="st">&quot;</span><span class="va">$NVM_DIR</span><span class="st">/nvm.sh&quot;</span></span></code></pre></div>
<p>重開終端機，或直接跑這段讓它生效。</p>
<h3 id="b.-裝-lts-版本">b. 裝 LTS 版本</h3>
<div class="sourceCode" id="cb4"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="ex">nvm</span> install <span class="at">--lts</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="ex">nvm</span> use <span class="at">--lts</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="ex">nvm</span> alias default <span class="st">&#39;lts/*&#39;</span></span></code></pre></div>
<p>檢查一下版本，確認沒問題：</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="ex">node</span> <span class="at">-v</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="ex">npm</span> <span class="at">-v</span></span></code></pre></div>
<hr />
<h2 id="裝-mongodb-8.0">3. 裝 MongoDB 8.0</h2>
<p>MongoDB 是這專案的資料庫，Ubuntu 和 macOS 裝法不一樣。</p>
<h3 id="ubuntu">Ubuntu</h3>
<div class="sourceCode" id="cb6"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> apt-get install <span class="at">-y</span> gnupg curl</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-fsSL</span> https://www.mongodb.org/static/pgp/server-8.0.asc <span class="kw">|</span> <span class="dt">\</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>   <span class="fu">sudo</span> gpg <span class="at">-o</span> /usr/share/keyrings/mongodb-server-8.0.gpg <span class="at">--dearmor</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;deb [ arch=amd64,arm64 signed-by=/usr/share/keyrings/mongodb-server-8.0.gpg ] https://repo.mongodb.org/apt/ubuntu noble/mongodb-org/8.0 multiverse&quot;</span> <span class="kw">|</span> <span class="fu">sudo</span> tee /etc/apt/sources.list.d/mongodb-org-8.0.list</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> apt-get update</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> apt-get install <span class="at">-y</span> mongodb-org</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> systemctl start mongod</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> systemctl enable mongod</span></code></pre></div>
<h3 id="macos">macOS</h3>
<p>用 Homebrew，裝 6.0 版（8.0 可能有相容性問題）：</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="ex">brew</span> tap mongodb/brew</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="ex">brew</span> install mongodb-community@6.0</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="ex">brew</span> services start mongodb-community@6.0</span></code></pre></div>
<hr />
<h2 id="裝-php">4. 裝 PHP</h2>
<p>前端要用 PHP 跑，簡單裝一下：</p>
<h3 id="ubuntu-1">Ubuntu</h3>
<div class="sourceCode" id="cb8"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> apt install <span class="at">-y</span> php php-cli php-mbstring php-xml php-json</span></code></pre></div>
<h3 id="macos-1">macOS</h3>
<div class="sourceCode" id="cb9"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="ex">brew</span> install php</span></code></pre></div>
<p>檢查版本：</p>
<div class="sourceCode" id="cb10"><pre
class="sourceCode sh"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="ex">php</span> <span class="at">-v</span></span></code></pre></div>
<hr />
<h2 id="拉專案下來">5. 拉專案下來</h2>
<p>從 GitHub 把專案抓下來：</p>
<div class="sourceCode" id="cb11"><pre
class="sourceCode sh"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> clone https://github.com/TheSocialCode/CopyPaste.me.git</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> CopyPaste.me</span></code></pre></div>
<hr />
<h2 id="裝-node-依賴">6. 裝 Node 依賴</h2>
<p>進專案資料夾，裝依賴前先把 <code>node-sass</code> 換成
<code>sass</code>：</p>
<div class="sourceCode" id="cb12"><pre
class="sourceCode sh"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="ex">npm</span> uninstall node-sass</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="ex">npm</span> install sass</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="ex">npm</span> install</span></code></pre></div>
<hr />
<h2 id="設定專案">7. 設定專案</h2>
<ol type="1">
<li><p>複製設定檔範本：</p>
<div class="sourceCode" id="cb13"><pre
class="sourceCode sh"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cp</span> CopyPaste.config.json-dist CopyPaste.config.json</span></code></pre></div></li>
<li><p>編輯 <code>CopyPaste.config.json</code>，把 MongoDB
連線資訊填好：</p>
<div class="sourceCode" id="cb14"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="er">&quot;mongodb&quot;:</span> <span class="fu">&#123;</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;host&quot;</span><span class="fu">:</span> <span class="st">&quot;127.0.0.1&quot;</span><span class="fu">,</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;port&quot;</span><span class="fu">:</span> <span class="dv">27017</span><span class="fu">,</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;dbname&quot;</span><span class="fu">:</span> <span class="st">&quot;copypaste&quot;</span><span class="fu">,</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;username&quot;</span><span class="fu">:</span> <span class="st">&quot;copypaste&quot;</span><span class="fu">,</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;password&quot;</span><span class="fu">:</span> <span class="st">&quot;password123456789&quot;</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="fu">&#125;</span></span></code></pre></div>
<p>如果要用 HTTPS，SSL 路徑晚點再填（見步驟 9）。</p></li>
</ol>
<hr />
<h2 id="搞定-mongodb-資料庫">8. 搞定 MongoDB 資料庫</h2>
<p>連到 MongoDB：</p>
<div class="sourceCode" id="cb15"><pre
class="sourceCode sh"><code class="sourceCode bash"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="ex">mongosh</span></span></code></pre></div>
<p>在 MongoDB Shell 裡跑這段：</p>
<div class="sourceCode" id="cb16"><pre
class="sourceCode js"><code class="sourceCode javascript"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>use copypaste</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>db<span class="op">.</span><span class="fu">createUser</span>(&#123;</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">user</span><span class="op">:</span> <span class="st">&quot;copypaste&quot;</span><span class="op">,</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="dt">pwd</span><span class="op">:</span> <span class="st">&quot;password123&quot;</span><span class="op">,</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="dt">roles</span><span class="op">:</span> [ &#123; <span class="dt">role</span><span class="op">:</span> <span class="st">&quot;readWrite&quot;</span><span class="op">,</span> <span class="dt">db</span><span class="op">:</span> <span class="st">&quot;copypaste&quot;</span> &#125; ]</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>&#125;)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>exit</span></code></pre></div>
<hr />
<h2 id="加個-ssl-選用">9. 加個 SSL (選用)</h2>
<p>想用 HTTPS？自己簽個憑證試試：</p>
<div class="sourceCode" id="cb17"><pre
class="sourceCode sh"><code class="sourceCode bash"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> <span class="at">-p</span> ssl</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="ex">openssl</span> req <span class="at">-x509</span> <span class="at">-newkey</span> rsa:4096 <span class="at">-sha256</span> <span class="at">-days</span> 365 <span class="at">-nodes</span> <span class="dt">\</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">-nodes</span> <span class="at">-keyout</span> ssl/server.key <span class="at">-out</span> ssl/server.crt <span class="dt">\</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">-keyout</span> ssl/server.key <span class="at">-out</span> ssl/server.crt <span class="dt">\</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">-subj</span> <span class="st">&quot;/CN=localhost&quot;</span></span></code></pre></div>
<p>然後在 <code>CopyPaste.config.json</code> 裡加 SSL 路徑：</p>
<div class="sourceCode" id="cb18"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="er">&quot;ssl&quot;:</span> <span class="fu">&#123;</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;key&quot;</span><span class="fu">:</span> <span class="st">&quot;/path/to/server.key&quot;</span><span class="fu">,</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;certificate&quot;</span><span class="fu">:</span> <span class="st">&quot;/path/to/server.crt&quot;</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="fu">&#125;</span></span></code></pre></div>
<p>記得把路徑換成真的！</p>
<hr />
<h2 id="建置前端">10. 建置前端</h2>
<p>跑這行建置前端：</p>
<div class="sourceCode" id="cb19"><pre
class="sourceCode sh"><code class="sourceCode bash"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="ex">npm</span> run build</span></code></pre></div>
<p>沒反應？試試：</p>
<div class="sourceCode" id="cb20"><pre
class="sourceCode sh"><code class="sourceCode bash"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="ex">npx</span> webpack <span class="at">--config</span> webpack.config.js</span></code></pre></div>
<p>輸出會在 <code>web/static/dist/</code>。</p>
<hr />
<h2 id="啟動後端">11. 啟動後端</h2>
<h3 id="正式環境">正式環境</h3>
<p>直接開跑：</p>
<div class="sourceCode" id="cb21"><pre
class="sourceCode sh"><code class="sourceCode bash"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="ex">node</span> app/server/CopyPaste.server.js</span></code></pre></div>
<h3 id="開發環境">開發環境</h3>
<p>不想用 SSL 或 MongoDB 驗證：</p>
<div class="sourceCode" id="cb22"><pre
class="sourceCode sh"><code class="sourceCode bash"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="ex">node</span> app/server/CopyPaste.server.js https=false mongoAuthenticate=false</span></code></pre></div>
<h3 id="用-pm2推薦">用 pm2（推薦）</h3>
<p>裝 pm2：</p>
<div class="sourceCode" id="cb23"><pre
class="sourceCode sh"><code class="sourceCode bash"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="ex">npm</span> install <span class="at">-g</span> pm2</span></code></pre></div>
<p>然後用 pm2 跑：</p>
<div class="sourceCode" id="cb24"><pre
class="sourceCode sh"><code class="sourceCode bash"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="ex">pm2</span> start app/server/CopyPaste.server.js <span class="at">--mode</span><span class="op">=</span>dev https=false</span></code></pre></div>
<hr />
<h2 id="跑前端">12. 跑前端</h2>
<p>進 <code>web</code> 資料夾，用 PHP 開個 server：</p>
<div class="sourceCode" id="cb25"><pre
class="sourceCode sh"><code class="sourceCode bash"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> web</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="ex">php</span> <span class="at">-S</span> 0.0.0.0:8080</span></code></pre></div>
<p>瀏覽器打開：<a
target="_blank" rel="noopener" href="http://localhost:8080/">http://localhost:8080/</a></p>
<hr />
<h2 id="設成服務-選用">13. 設成服務 (選用 )</h2>
<p>想讓後端一直跑？用 <strong>pm2` 或 </strong>systemd**。pm2
簡單，直接參考步驟 11；systemd 就自己去查文件，應該難不倒你！</p>
<hr />
<h2 id="遇到問題">14. 遇到問題？</h2>
<ul>
<li><p><strong>3000 埠看到 “Cannot GET /”?</strong><br />
→ 你跑錯地方了，去 <a
target="_blank" rel="noopener" href="http://localhost:8080/">http://localhost:8080/</a> 才對。</p></li>
<li><p><strong>頁面空白？</strong><br />
→ F12 開控制台，看看有啥報錯。PHP 日誌也瞄一下。</p></li>
<li><p><strong>MongoDB 連不上？</strong><br />
→ 檢查 <code>mongod</code>
有沒有跑（<code>sudo systemctl status mongod</code>），再確認
<code>CopyPaste.config.json</code> 裡的帳密對不對。</p></li>
</ul>
<hr />
<h2 id="小撇步">15. 小撇步</h2>
<ul>
<li>裝東西前，確認 Node.js、MongoDB、PHP 版本，避免踩雷。</li>
<li>可以試試 Docker 或雲端部署，省事又穩。</li>
</ul>
<hr />
<p>搞定～你的 CopyPaste.me
應該已經跑起來了！有啥狀況，翻翻問題排除，或去 GitHub
官方文件找救兵。😎</p>

            
        </div>
    </div>
    <div class="post-tags">
        
        <span class="icon">
            <i class="fa-solid fa-tags fa-fw"></i>
        </span>
        
        
        
        <span class="tag">
            
            <a href="/tags/setup/" style="color: #03a9f4">setup</a>
        </span>
        
        <span class="tag">
            
            <a href="/tags/copypaste/" style="color: #00a596">copypaste</a>
        </span>
        
    </div>
    <a href="/2025/06/25/setup-copypasteme-guide/" class="go-post">閱讀全文</a>
</div>


        <div class="page-current">
    
    <span class="current">1</span>
    
    <a class="page-num" href="/page/2">
        2
    </a>
    
    
    
    
    <a class="page-num" href="/page/2/">
        <i class="fa-solid fa-caret-right fa-fw"></i>
    </a>
    
</div>

    </div>
    
    <div id="home-card">
        <div id="card-style">
    <div id="card-div">
        <div class="avatar">
            <img src="/images/avatar.gif" alt="avatar" />
        </div>
        <div class="name">t2o0n321</div>
        <div class="description">
            <p>好想睡覺想睡覺…🐭</p>

        </div>
        
        
        <div class="friend-links">
            
            <div class="friend-link">
                <a target="_blank" rel="noopener" href="https://t2o0n321.github.io/about/">About me</a>
            </div>
            
        </div>
        
    </div>
</div>

    </div>
    
</div>

            <footer id="footer">
    <div id="footer-wrap">
        <div>
            &copy;
            2024 - 2025 t2o0n321.blog
            <span id="footer-icon">
                <i class="fa-solid fa-font-awesome fa-fw"></i>
            </span>
            &commat;t2o0n321
        </div>
        <div>
            Based on the <a target="_blank" rel="noopener" href="https://hexo.io">Hexo Engine</a> &amp;
            <a target="_blank" rel="noopener" href="https://github.com/theme-particlex/hexo-theme-particlex">ParticleX Theme</a>
        </div>
        
    </div>
</footer>

        </div>
        
        <transition name="fade">
            <div id="preview" ref="preview" v-show="previewShow">
                <img id="preview-content" ref="previewContent" />
            </div>
        </transition>
        
    </div>
    <script src="/js/main.js"></script>
    
</body>
</html>
